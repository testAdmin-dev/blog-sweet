<script>
  import { getLocalTheme, getSystemTheme, changePageTheme } from '@/utils/theme'

  // 哀悼日
  const MOURNING_DAYS = [
    // “七七事变”（1937年7月7日—7月31日），又称“卢沟桥事变”，发生于1937年7月7日，为中国抗日战争全面爆发的起点。
    '7-7',
    // “九·一八事变”，又称“奉天事变”、“柳条湖事件” [1]，是1931年9月18日日本驻中国东北地区的关东军突然袭击奉天（今沈阳），以武力侵占东北的事件。
    '9-18',
    // 1937年12月13日，日本侵略军占领南京，在华中遣军司令松井石根和第六师团长谷寿夫指挥下，制造了震惊中外的南京大屠杀。
    '12-13',
    // 2020年4月4日‌：为表达全国各族人民对抗击新冠肺炎疫情斗争牺牲烈士和逝世同胞的深切哀悼，国务院决定举行全国性哀悼活动。
    '4-4',
    // 2008年5月12日，四川省阿坝藏族羌族自治州汶川县发生8.0级特大地震
    '5-12',
  ]

  function isMourningDay() {
    const today = new Date()
    const dateStr = `${today.getMonth() + 1}-${today.getDate()}`
    return MOURNING_DAYS.includes(dateStr)
  }

  function load() {
    const localTheme = getLocalTheme()
    const systemTheme = getSystemTheme()
    if (localTheme === 'system') {
      changePageTheme(systemTheme)
    } else {
      changePageTheme(localTheme)
    }
    if (isMourningDay()) {
      document.documentElement.classList.add('gray')
    }
  }

  load()

  // document.addEventListener('swup:content:replace', load)
</script>
